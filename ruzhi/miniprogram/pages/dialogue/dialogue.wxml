<!--AIå¯¹è¯é¡µé¢-->
<view class="page-container traditional-bg">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <view class="page-title">ğŸ’¬ AIå¤ä»£å…ˆè´¤å¯¹è¯</view>
    <view class="page-subtitle">ä¸å†å²ä¸Šçš„æ™ºè€…è¿›è¡Œæ·±åº¦äº¤æµ</view>
  </view>

  <!-- äººç‰©é€‰æ‹© -->
  <view class="characters-section">
    <view class="card">
      <view class="card-title">ğŸ­ é€‰æ‹©å¯¹è¯äººç‰©</view>
      <view class="characters-grid">
        <view 
          class="character-item {{selectedCharacter === item.id ? 'active' : ''}}" 
          wx:for="{{characters}}" 
          wx:key="id"
          bindtap="selectCharacter"
          data-character="{{item.id}}"
        >
          <view class="character-avatar">
            <image src="{{item.avatar}}" mode="aspectFill"></image>
          </view>
          <view class="character-info">
            <view class="character-name">{{item.name}}</view>
            <view class="character-title">{{item.title}}</view>
            <view class="character-period">{{item.period}}</view>
          </view>
          <view class="character-specialty">
            <view class="specialty-tag" wx:for="{{item.specialties}}" wx:key="*this" wx:for-item="specialty">
              {{specialty}}
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- å¯¹è¯å†å² -->
  <view class="conversations-section" wx:if="{{conversations.length > 0}}">
    <view class="card">
      <view class="card-title">ğŸ“š æœ€è¿‘å¯¹è¯</view>
      <view class="conversations-list">
        <view 
          class="conversation-item" 
          wx:for="{{conversations}}" 
          wx:key="id"
          bindtap="continueConversation"
          data-conversation="{{item}}"
        >
          <view class="conversation-avatar">
            <image src="{{getCharacterById(item.characterId).avatar}}" mode="aspectFill"></image>
          </view>
          <view class="conversation-content">
            <view class="conversation-title">
              ä¸{{getCharacterById(item.characterId).name}}çš„å¯¹è¯
            </view>
            <view class="conversation-preview">{{item.lastMessage}}</view>
            <view class="conversation-meta">
              <text class="conversation-time">{{item.lastTime}}</text>
              <text class="conversation-count">{{item.messageCount}}æ¡æ¶ˆæ¯</text>
            </view>
          </view>
          <view class="conversation-arrow">â€º</view>
        </view>
      </view>
    </view>
  </view>

  <!-- å¿«é€Ÿè¯é¢˜ -->
  <view class="topics-section" wx:if="{{selectedCharacter}}">
    <view class="card">
      <view class="card-title">ğŸ’¡ æ¨èè¯é¢˜</view>
      <view class="topics-grid">
        <view 
          class="topic-item" 
          wx:for="{{getTopicsByCharacter(selectedCharacter)}}" 
          wx:key="id"
          bindtap="startTopicChat"
          data-topic="{{item}}"
        >
          <view class="topic-icon">{{item.icon}}</view>
          <view class="topic-title">{{item.title}}</view>
          <view class="topic-desc">{{item.description}}</view>
        </view>
      </view>
    </view>
  </view>

  <!-- äººç‰©ä»‹ç» -->
  <view class="character-intro" wx:if="{{selectedCharacter}}">
    <view class="card">
      <view class="card-title">ğŸ“– äººç‰©ä»‹ç»</view>
      <view class="intro-content">
        <view class="intro-header">
          <view class="intro-avatar">
            <image src="{{getCharacterById(selectedCharacter).avatar}}" mode="aspectFill"></image>
          </view>
          <view class="intro-basic">
            <view class="intro-name">{{getCharacterById(selectedCharacter).name}}</view>
            <view class="intro-title">{{getCharacterById(selectedCharacter).title}}</view>
            <view class="intro-period">{{getCharacterById(selectedCharacter).period}}</view>
          </view>
        </view>
        <view class="intro-description">
          {{getCharacterById(selectedCharacter).description}}
        </view>
        <view class="intro-achievements">
          <view class="achievement-title">ä¸»è¦æˆå°±ï¼š</view>
          <view class="achievement-list">
            <view class="achievement-item" wx:for="{{getCharacterById(selectedCharacter).achievements}}" wx:key="*this">
              â€¢ {{item}}
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- å¼€å§‹å¯¹è¯æŒ‰é’® -->
  <view class="start-chat-section" wx:if="{{selectedCharacter}}">
    <view class="start-chat-btn btn-primary" bindtap="startNewChat">
      <view class="chat-icon">ğŸ’­</view>
      <view class="chat-text">å¼€å§‹ä¸{{getCharacterById(selectedCharacter).name}}å¯¹è¯</view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{!selectedCharacter}}">
    <view class="empty-icon">ğŸ­</view>
    <view class="empty-text">è¯·é€‰æ‹©ä¸€ä½å¤ä»£å…ˆè´¤å¼€å§‹å¯¹è¯</view>
    <view class="empty-desc">æ¯ä½å…ˆè´¤éƒ½æœ‰ç‹¬ç‰¹çš„æ€æƒ³å’Œæ™ºæ…§ç­‰å¾…æ‚¨çš„æ¢ç´¢</view>
  </view>
</view>
