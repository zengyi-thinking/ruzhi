# å„’æ™ºå°ç¨‹åº AI æ™ºèƒ½åŒ–åŠŸèƒ½é›†æˆæŒ‡å—

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

æœ¬æ¬¡æ›´æ–°ä¸ºå„’æ™ºå°ç¨‹åºé›†æˆäº†AIæ™ºèƒ½åŒ–åŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼š

1. **é¦–é¡µè·³è½¬ä¿®å¤** - ä¿®å¤TabBaré¡µé¢è·³è½¬é—®é¢˜
2. **AIå†å²äººç‰©å¯¹è¯** - ä¸å­”å­ã€è€å­ç­‰å†å²äººç‰©æ™ºèƒ½å¯¹è¯
3. **OCRæ™ºèƒ½è§£é‡Š** - å¯¹è¯†åˆ«çš„å¤ç±æ–‡å­—æä¾›AIè§£é‡Š
4. **çŸ¥è¯†é—®ç­”** - ä¼ ç»Ÿæ–‡åŒ–ç›¸å…³é—®é¢˜çš„æ™ºèƒ½å›ç­”

## ğŸ”§ æŠ€æœ¯æ¶æ„

### å‰ç«¯ï¼ˆå°ç¨‹åºï¼‰
```
pages/
â”œâ”€â”€ home/home.js          # ä¿®å¤è·³è½¬é€»è¾‘
â”œâ”€â”€ chat/chat.js          # AIå¯¹è¯åŠŸèƒ½
â”œâ”€â”€ ocr/ocr.js           # OCR + AIè§£é‡Š
â””â”€â”€ ...

utils/
â”œâ”€â”€ ai.js                # AIæœåŠ¡æ ¸å¿ƒæ¨¡å—
â””â”€â”€ request.js           # ç½‘ç»œè¯·æ±‚å·¥å…·

config/
â””â”€â”€ ai.js                # AIé…ç½®æ–‡ä»¶
```

### åç«¯ï¼ˆä»£ç†æœåŠ¡ï¼‰
```
backend/
â””â”€â”€ ai-proxy-server.js   # Node.jsä»£ç†æœåŠ¡å™¨
```

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### 1. åç«¯ä»£ç†æœåŠ¡éƒ¨ç½²

#### æœ¬åœ°å¼€å‘ç¯å¢ƒ
```bash
# 1. è¿›å…¥åç«¯ç›®å½•
cd ruzhi/backend

# 2. å®‰è£…ä¾èµ–
npm install express cors axios dotenv

# 3. åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶
echo "DEEPSEEK_API_KEY=your_deepseek_api_key_here" > .env
echo "PORT=3000" >> .env

# 4. å¯åŠ¨æœåŠ¡
node ai-proxy-server.js
```

#### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
```bash
# ä½¿ç”¨ PM2 éƒ¨ç½²
npm install -g pm2
pm2 start ai-proxy-server.js --name "ruzhi-ai-proxy"

# æˆ–ä½¿ç”¨ Docker
docker build -t ruzhi-ai-proxy .
docker run -d -p 3000:3000 --env-file .env ruzhi-ai-proxy
```

### 2. è·å– DeepSeek API å¯†é’¥

1. è®¿é—® [DeepSeek å®˜ç½‘](https://platform.deepseek.com/)
2. æ³¨å†Œè´¦å·å¹¶è·å– API Key
3. å°† API Key é…ç½®åˆ°åç«¯æœåŠ¡çš„ç¯å¢ƒå˜é‡ä¸­

### 3. å°ç¨‹åºé…ç½®

#### ä¿®æ”¹ AI é…ç½®æ–‡ä»¶
```javascript
// config/ai.js
const AI_CONFIG = {
  production: {
    backendUrl: 'https://your-domain.com/api', // æ›¿æ¢ä¸ºä½ çš„åç«¯åŸŸå
    mockEnabled: false,
    timeout: 30000
  }
}
```

#### é…ç½®æœåŠ¡å™¨åŸŸå
åœ¨å¾®ä¿¡å°ç¨‹åºåå°æ·»åŠ æœåŠ¡å™¨åŸŸåï¼š
- requeståˆæ³•åŸŸåï¼š`https://your-domain.com`

## ğŸ”‘ API å¯†é’¥å®‰å…¨

### é‡è¦æé†’
- **ç»å¯¹ä¸è¦**åœ¨å°ç¨‹åºä»£ç ä¸­ç›´æ¥ä½¿ç”¨ API å¯†é’¥
- **å¿…é¡»**é€šè¿‡åç«¯ä»£ç†æœåŠ¡è°ƒç”¨ AI API
- **å»ºè®®**ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†æ•æ„Ÿä¿¡æ¯

### å®‰å…¨æœ€ä½³å®è·µ
```javascript
// âŒ é”™è¯¯åšæ³• - ç›´æ¥åœ¨å°ç¨‹åºä¸­è°ƒç”¨
const response = await wx.request({
  url: 'https://api.deepseek.com/v1/chat/completions',
  header: {
    'Authorization': 'Bearer your-api-key' // å±é™©ï¼
  }
})

// âœ… æ­£ç¡®åšæ³• - é€šè¿‡åç«¯ä»£ç†
const response = await request.post('/api/ai/chat', {
  character: 'å­”å­',
  message: 'ä»€ä¹ˆæ˜¯ä»ï¼Ÿ'
})
```

## ğŸ“± åŠŸèƒ½ä½¿ç”¨è¯´æ˜

### 1. é¦–é¡µè·³è½¬ä¿®å¤

**é—®é¢˜**ï¼šç‚¹å‡»åŠŸèƒ½å›¾æ ‡æ— æ³•è·³è½¬åˆ°å¯¹åº”é¡µé¢
**è§£å†³**ï¼šä¿®å¤äº† `wx.navigateTo` å’Œ `wx.switchTab` çš„ä½¿ç”¨

```javascript
// ä¿®å¤å‰
wx.navigateTo({ url: '/pages/chat/chat' }) // âŒ TabBaré¡µé¢ä¸èƒ½ç”¨navigateTo

// ä¿®å¤å
wx.switchTab({ url: '/pages/chat/chat' })  // âœ… æ­£ç¡®ä½¿ç”¨switchTab
```

### 2. AIå†å²äººç‰©å¯¹è¯

**åŠŸèƒ½**ï¼šä¸å­”å­ã€è€å­ã€å­Ÿå­ç­‰å†å²äººç‰©è¿›è¡Œæ™ºèƒ½å¯¹è¯

**ä½¿ç”¨æ–¹æ³•**ï¼š
1. è¿›å…¥"å¯¹è¯"é¡µé¢
2. é€‰æ‹©å†å²äººç‰©
3. è¾“å…¥é—®é¢˜å¼€å§‹å¯¹è¯

**æŠ€æœ¯å®ç°**ï¼š
```javascript
// è°ƒç”¨AIå¯¹è¯æœåŠ¡
const response = await aiService.chatWithHistoricalFigure(
  'å­”å­',           // å†å²äººç‰©
  'ä»€ä¹ˆæ˜¯ä»ï¼Ÿ',      // ç”¨æˆ·é—®é¢˜
  conversationHistory // å¯¹è¯å†å²
)
```

### 3. OCRæ™ºèƒ½è§£é‡Š

**åŠŸèƒ½**ï¼šå¯¹è¯†åˆ«çš„å¤ç±æ–‡å­—æä¾›AIæ™ºèƒ½è§£é‡Š

**ä½¿ç”¨æ–¹æ³•**ï¼š
1. è¿›å…¥"è¯†åˆ«"é¡µé¢
2. æ‹ç…§æˆ–é€‰æ‹©å›¾ç‰‡
3. ç³»ç»Ÿè‡ªåŠ¨è¯†åˆ«æ–‡å­—å¹¶æä¾›AIè§£é‡Š

**æŠ€æœ¯å®ç°**ï¼š
```javascript
// OCRè¯†åˆ«æˆåŠŸåè‡ªåŠ¨è°ƒç”¨AIè§£é‡Š
const explanationResult = await aiService.explainOCRText(result.text)
if (explanationResult.success) {
  // æ˜¾ç¤ºAIè§£é‡Š
  result.aiExplanation = explanationResult.explanation
}
```

### 4. çŸ¥è¯†é—®ç­”

**åŠŸèƒ½**ï¼šå›ç­”ä¼ ç»Ÿæ–‡åŒ–ç›¸å…³é—®é¢˜

**ä½¿ç”¨æ–¹æ³•**ï¼š
```javascript
const answer = await aiService.answerQuestion(
  'å„’å®¶æ€æƒ³çš„æ ¸å¿ƒæ˜¯ä»€ä¹ˆï¼Ÿ',
  'philosophy'
)
```

## ğŸ”„ é™çº§æ–¹æ¡ˆ

å½“AIæœåŠ¡ä¸å¯ç”¨æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å¯ç”¨é™çº§æ–¹æ¡ˆï¼š

### 1. æ¨¡æ‹Ÿå›ç­”
```javascript
// å†å²äººç‰©å¯¹è¯é™çº§
generateMockResponse(character, message) {
  const responses = {
    'å­”å­': ['å­¦è€Œæ—¶ä¹ ä¹‹ï¼Œä¸äº¦è¯´ä¹ï¼Ÿ', 'å·±æ‰€ä¸æ¬²ï¼Œå‹¿æ–½äºäººã€‚'],
    'è€å­': ['é“å¯é“ï¼Œéå¸¸é“ã€‚', 'æ— ä¸ºè€Œæ— ä¸ä¸ºã€‚']
  }
  return responses[character][Math.floor(Math.random() * responses[character].length)]
}
```

### 2. æœ¬åœ°ç¼“å­˜
- ç¼“å­˜å¸¸è§é—®é¢˜çš„å›ç­”
- ç¦»çº¿æ¨¡å¼ä¸‹ä½¿ç”¨æœ¬åœ°æ•°æ®
- ç½‘ç»œæ¢å¤ååŒæ­¥æœ€æ–°å†…å®¹

## ğŸ§ª æµ‹è¯•éªŒè¯

### 1. åŠŸèƒ½æµ‹è¯•æ¸…å•

#### é¦–é¡µè·³è½¬æµ‹è¯•
- [ ] ç‚¹å‡»"å¤ç±è¯†åˆ«"å›¾æ ‡è·³è½¬åˆ°OCRé¡µé¢
- [ ] ç‚¹å‡»"äººç‰©å¯¹è¯"å›¾æ ‡è·³è½¬åˆ°èŠå¤©é¡µé¢
- [ ] ç‚¹å‡»"çŸ¥è¯†å›¾è°±"å›¾æ ‡è·³è½¬åˆ°çŸ¥è¯†é¡µé¢
- [ ] ç‚¹å‡»"æˆ‘çš„"å›¾æ ‡è·³è½¬åˆ°ä¸ªäººä¸­å¿ƒ

#### AIå¯¹è¯æµ‹è¯•
- [ ] é€‰æ‹©å†å²äººç‰©ï¼ˆå­”å­ã€è€å­ç­‰ï¼‰
- [ ] å‘é€æ¶ˆæ¯å¹¶æ¥æ”¶AIå›å¤
- [ ] æµ‹è¯•æ‰“å­—æœºæ•ˆæœ
- [ ] æµ‹è¯•å¯¹è¯å†å²ä¿å­˜

#### OCRæ™ºèƒ½è§£é‡Šæµ‹è¯•
- [ ] ä¸Šä¼ å¤ç±å›¾ç‰‡
- [ ] éªŒè¯OCRè¯†åˆ«ç»“æœ
- [ ] æ£€æŸ¥AIè§£é‡Šå†…å®¹
- [ ] æµ‹è¯•ç»“æœé¡µé¢æ˜¾ç¤º

### 2. æ€§èƒ½æµ‹è¯•
- [ ] AIå“åº”æ—¶é—´ < 10ç§’
- [ ] é™çº§æ–¹æ¡ˆå“åº”æ—¶é—´ < 2ç§’
- [ ] å†…å­˜ä½¿ç”¨æ­£å¸¸
- [ ] ç½‘ç»œå¼‚å¸¸å¤„ç†æ­£ç¡®

### 3. å…¼å®¹æ€§æµ‹è¯•
- [ ] iOS å¾®ä¿¡å°ç¨‹åº
- [ ] Android å¾®ä¿¡å°ç¨‹åº
- [ ] ä¸åŒç½‘ç»œç¯å¢ƒ
- [ ] APIæœåŠ¡å¼‚å¸¸æƒ…å†µ

## ğŸ› å¸¸è§é—®é¢˜

### 1. AIæœåŠ¡æ— å“åº”
**åŸå› **ï¼šåç«¯æœåŠ¡æœªå¯åŠ¨æˆ–APIå¯†é’¥é”™è¯¯
**è§£å†³**ï¼š
```bash
# æ£€æŸ¥åç«¯æœåŠ¡çŠ¶æ€
curl http://localhost:3000/api/health

# æ£€æŸ¥APIå¯†é’¥é…ç½®
echo $DEEPSEEK_API_KEY
```

### 2. è·³è½¬å¤±è´¥
**åŸå› **ï¼šä½¿ç”¨äº†é”™è¯¯çš„è·³è½¬æ–¹æ³•
**è§£å†³**ï¼šTabBaré¡µé¢ä½¿ç”¨ `wx.switchTab`ï¼Œæ™®é€šé¡µé¢ä½¿ç”¨ `wx.navigateTo`

### 3. OCRè§£é‡Šä¸æ˜¾ç¤º
**åŸå› **ï¼šAIæœåŠ¡è°ƒç”¨å¤±è´¥
**è§£å†³**ï¼šæ£€æŸ¥ç½‘ç»œè¿æ¥å’Œåç«¯æœåŠ¡çŠ¶æ€

### 4. å¯¹è¯å†å²ä¸¢å¤±
**åŸå› **ï¼šæœ¬åœ°å­˜å‚¨å¤±è´¥
**è§£å†³**ï¼šæ£€æŸ¥å­˜å‚¨æƒé™å’Œå®¹é‡

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### 1. å…³é”®æŒ‡æ ‡
- AI APIè°ƒç”¨æˆåŠŸç‡
- å¹³å‡å“åº”æ—¶é—´
- ç”¨æˆ·æ´»è·ƒåº¦
- åŠŸèƒ½ä½¿ç”¨é¢‘ç‡

### 2. æ—¥å¿—è®°å½•
```javascript
// è®°å½•AIæœåŠ¡è°ƒç”¨
console.log('AIæœåŠ¡è°ƒç”¨:', {
  function: 'chatWithHistoricalFigure',
  character: character,
  success: response.success,
  responseTime: Date.now() - startTime
})
```

## ğŸ”® åç»­ä¼˜åŒ–

### 1. åŠŸèƒ½å¢å¼º
- [ ] æ”¯æŒæ›´å¤šå†å²äººç‰©
- [ ] å¢åŠ è¯­éŸ³å¯¹è¯åŠŸèƒ½
- [ ] ä¼˜åŒ–AIå›ç­”è´¨é‡
- [ ] æ·»åŠ ä¸ªæ€§åŒ–æ¨è

### 2. æ€§èƒ½ä¼˜åŒ–
- [ ] å®ç°è¯·æ±‚ç¼“å­˜
- [ ] ä¼˜åŒ–ç½‘ç»œè¯·æ±‚
- [ ] å‡å°‘åŒ…ä½“ç§¯
- [ ] æå‡åŠ è½½é€Ÿåº¦

### 3. ç”¨æˆ·ä½“éªŒ
- [ ] ä¼˜åŒ–ç•Œé¢è®¾è®¡
- [ ] å¢åŠ åŠ¨ç”»æ•ˆæœ
- [ ] å®Œå–„é”™è¯¯æç¤º
- [ ] æ·»åŠ ä½¿ç”¨å¼•å¯¼

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. åç«¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
2. APIå¯†é’¥æ˜¯å¦æ­£ç¡®é…ç½®
3. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
4. å°ç¨‹åºåŸŸåæ˜¯å¦å·²é…ç½®

**éƒ¨ç½²å®Œæˆåï¼Œå„’æ™ºå°ç¨‹åºå°†å…·å¤‡å®Œæ•´çš„AIæ™ºèƒ½åŒ–åŠŸèƒ½ï¼** ğŸ‰
