<!--æˆå°±ç³»ç»Ÿé¡µé¢-->
<view class="achievements-container">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="header-section">
    <view class="header-bg">
      <view class="header-content">
        <text class="page-title">ğŸ† æˆ‘çš„æˆå°±</text>
        <text class="page-desc">è®°å½•æ‚¨çš„å­¦ä¹ é‡Œç¨‹ç¢‘</text>
      </view>
    </view>
  </view>

  <!-- æˆå°±ç»Ÿè®¡ -->
  <view class="stats-section">
    <view class="stats-card">
      <view class="stat-item">
        <text class="stat-number">{{achievementStats.total}}</text>
        <text class="stat-label">æ€»æˆå°±</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{achievementStats.unlocked}}</text>
        <text class="stat-label">å·²è§£é”</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{achievementStats.points}}</text>
        <text class="stat-label">æˆå°±ç‚¹æ•°</text>
      </view>
    </view>
  </view>

  <!-- æˆå°±åˆ†ç±» -->
  <view class="category-section">
    <scroll-view class="category-scroll" scroll-x="true" show-scrollbar="false">
      <view class="category-list">
        <view 
          class="category-item {{currentCategory === item.id ? 'active' : ''}}"
          wx:for="{{categories}}"
          wx:key="id"
          bindtap="onCategoryChange"
          data-category="{{item.id}}"
        >
          <text class="category-icon">{{item.icon}}</text>
          <text class="category-name">{{item.name}}</text>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- æˆå°±åˆ—è¡¨ -->
  <view class="achievements-section">
    <view class="achievements-list">
      <view 
        class="achievement-item {{item.unlocked ? 'unlocked' : 'locked'}}"
        wx:for="{{filteredAchievements}}"
        wx:key="id"
        bindtap="onAchievementClick"
        data-achievement="{{item}}"
      >
        <view class="achievement-icon">
          <text class="icon-text">{{item.icon}}</text>
          <view class="unlock-badge" wx:if="{{item.unlocked}}">âœ“</view>
        </view>
        
        <view class="achievement-content">
          <text class="achievement-title">{{item.title}}</text>
          <text class="achievement-desc">{{item.description}}</text>
          
          <view class="achievement-progress" wx:if="{{!item.unlocked && item.progress}}">
            <view class="progress-bar">
              <view class="progress-fill" style="width: {{item.progress.percentage}}%"></view>
            </view>
            <text class="progress-text">{{item.progress.current}}/{{item.progress.target}}</text>
          </view>
          
          <view class="achievement-meta">
            <text class="achievement-points">+{{item.points}} ç‚¹æ•°</text>
            <text class="achievement-date" wx:if="{{item.unlocked}}">{{item.unlockedDate}}</text>
            <text class="achievement-rarity {{item.rarity}}">{{item.rarityText}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- æœ€è¿‘è§£é” -->
  <view class="recent-section" wx:if="{{recentUnlocked.length > 0}}">
    <view class="section-header">
      <text class="section-title">ğŸ‰ æœ€è¿‘è§£é”</text>
    </view>
    
    <scroll-view class="recent-scroll" scroll-x="true" show-scrollbar="false">
      <view class="recent-list">
        <view 
          class="recent-item"
          wx:for="{{recentUnlocked}}"
          wx:key="id"
        >
          <text class="recent-icon">{{item.icon}}</text>
          <text class="recent-title">{{item.title}}</text>
          <text class="recent-date">{{item.unlockedDate}}</text>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- æˆå°±è¯¦æƒ…å¼¹çª— -->
  <view class="achievement-modal" wx:if="{{showModal}}" bindtap="onCloseModal">
    <view class="modal-content" catchtap="stopPropagation">
      <view class="modal-header">
        <text class="modal-icon">{{selectedAchievement.icon}}</text>
        <text class="modal-title">{{selectedAchievement.title}}</text>
        <text class="modal-close" bindtap="onCloseModal">Ã—</text>
      </view>
      
      <view class="modal-body">
        <text class="modal-desc">{{selectedAchievement.description}}</text>
        <text class="modal-detail">{{selectedAchievement.detail}}</text>
        
        <view class="modal-stats">
          <view class="modal-stat">
            <text class="stat-label">å¥–åŠ±ç‚¹æ•°</text>
            <text class="stat-value">{{selectedAchievement.points}}</text>
          </view>
          <view class="modal-stat">
            <text class="stat-label">ç¨€æœ‰åº¦</text>
            <text class="stat-value {{selectedAchievement.rarity}}">{{selectedAchievement.rarityText}}</text>
          </view>
          <view class="modal-stat" wx:if="{{selectedAchievement.unlocked}}">
            <text class="stat-label">è§£é”æ—¶é—´</text>
            <text class="stat-value">{{selectedAchievement.unlockedDate}}</text>
          </view>
        </view>
        
        <view class="modal-progress" wx:if="{{!selectedAchievement.unlocked && selectedAchievement.progress}}">
          <text class="progress-label">å®Œæˆè¿›åº¦</text>
          <view class="progress-bar">
            <view class="progress-fill" style="width: {{selectedAchievement.progress.percentage}}%"></view>
          </view>
          <text class="progress-text">{{selectedAchievement.progress.current}}/{{selectedAchievement.progress.target}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{!loading && filteredAchievements.length === 0}}">
    <view class="empty-icon">ğŸ†</view>
    <text class="empty-title">æš‚æ— æˆå°±</text>
    <text class="empty-desc">ç»§ç»­å­¦ä¹ ï¼Œè§£é”æ›´å¤šæˆå°±å§ï¼</text>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading-spinner">â³</view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>
</view>
