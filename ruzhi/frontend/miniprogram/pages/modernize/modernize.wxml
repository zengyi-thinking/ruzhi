<!--AIå¤æ–‡ç°ä»£åŒ–æ”¹å†™é¡µé¢-->
<view class="modernize-container">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="header-section">
    <view class="header-content">
      <text class="page-title">âœ¨ å¤æ–‡ç°ä»£åŒ–</text>
      <text class="page-desc">AIè®©å¤æ–‡ç„•å‘ç°ä»£å…‰å½©</text>
    </view>
  </view>

  <!-- è¾“å…¥åŒºåŸŸ -->
  <view class="input-section">
    <view class="input-card">
      <view class="input-header">
        <text class="input-title">ğŸ“ è¾“å…¥å¤æ–‡</text>
        <view class="input-actions">
          <text class="action-btn" bindtap="onSelectFromClassics">ä»ç»å…¸é€‰æ‹©</text>
          <text class="action-btn" bindtap="onClearInput">æ¸…ç©º</text>
        </view>
      </view>
      
      <textarea 
        class="ancient-input"
        placeholder="è¯·è¾“å…¥æ‚¨æƒ³è¦ç°ä»£åŒ–æ”¹å†™çš„å¤æ–‡å†…å®¹..."
        value="{{ancientText}}"
        bindinput="onAncientTextInput"
        maxlength="500"
        auto-height
      />
      
      <view class="input-footer">
        <text class="char-count">{{ancientText.length}}/500</text>
        <view class="quick-examples">
          <text class="example-label">å¿«é€Ÿç¤ºä¾‹ï¼š</text>
          <text 
            class="example-item"
            wx:for="{{quickExamples}}"
            wx:key="*this"
            bindtap="onSelectExample"
            data-text="{{item}}"
          >
            {{item}}
          </text>
        </view>
      </view>
    </view>
  </view>

  <!-- æ”¹å†™è®¾ç½® -->
  <view class="settings-section">
    <view class="settings-card">
      <text class="settings-title">ğŸ¨ æ”¹å†™è®¾ç½®</text>
      
      <!-- æ”¹å†™é£æ ¼ -->
      <view class="setting-group">
        <text class="group-title">æ”¹å†™é£æ ¼</text>
        <view class="style-options">
          <view 
            class="style-option {{selectedStyle === item.value ? 'active' : ''}}"
            wx:for="{{styleOptions}}"
            wx:key="value"
            bindtap="onStyleChange"
            data-style="{{item.value}}"
          >
            <text class="style-icon">{{item.icon}}</text>
            <text class="style-name">{{item.name}}</text>
            <text class="style-desc">{{item.description}}</text>
          </view>
        </view>
      </view>

      <!-- ç›®æ ‡å—ä¼— -->
      <view class="setting-group">
        <text class="group-title">ç›®æ ‡å—ä¼—</text>
        <view class="audience-options">
          <view 
            class="audience-option {{selectedAudience === item.value ? 'active' : ''}}"
            wx:for="{{audienceOptions}}"
            wx:key="value"
            bindtap="onAudienceChange"
            data-audience="{{item.value}}"
          >
            <text class="audience-icon">{{item.icon}}</text>
            <text class="audience-name">{{item.name}}</text>
          </view>
        </view>
      </view>

      <!-- ä¿ç•™ç¨‹åº¦ -->
      <view class="setting-group">
        <text class="group-title">æ–‡åŒ–å†…æ¶µä¿ç•™ç¨‹åº¦</text>
        <view class="preserve-slider">
          <slider 
            value="{{preserveLevel}}" 
            min="1" 
            max="5" 
            step="1"
            show-value
            bindchange="onPreserveLevelChange"
            activeColor="#667eea"
          />
          <view class="preserve-labels">
            <text class="preserve-label">ç®€åŒ–</text>
            <text class="preserve-label">ä¿ç•™</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- æ”¹å†™æŒ‰é’® -->
  <view class="action-section">
    <button 
      class="modernize-btn {{!ancientText.trim() ? 'disabled' : ''}}"
      bindtap="onStartModernize"
      disabled="{{!ancientText.trim() || loading}}"
    >
      <text class="btn-icon">{{loading ? 'â³' : 'âœ¨'}}</text>
      <text class="btn-text">{{loading ? 'AIæ­£åœ¨æ”¹å†™ä¸­...' : 'å¼€å§‹ç°ä»£åŒ–æ”¹å†™'}}</text>
    </button>
  </view>

  <!-- æ”¹å†™ç»“æœ -->
  <view class="result-section" wx:if="{{modernizeResult}}">
    <view class="result-card">
      <view class="result-header">
        <text class="result-title">ğŸ¯ æ”¹å†™ç»“æœ</text>
        <view class="result-actions">
          <text class="action-btn" bindtap="onCopyResult">å¤åˆ¶</text>
          <text class="action-btn" bindtap="onShareResult">åˆ†äº«</text>
          <text class="action-btn" bindtap="onSaveResult">ä¿å­˜</text>
        </view>
      </view>

      <!-- å¯¹æ¯”æ˜¾ç¤º -->
      <view class="comparison-view">
        <view class="comparison-item original">
          <text class="comparison-label">ğŸ“œ åŸæ–‡</text>
          <view class="text-content">
            <text class="text-display">{{ancientText}}</text>
          </view>
        </view>
        
        <view class="comparison-arrow">
          <text class="arrow-icon">â†’</text>
        </view>
        
        <view class="comparison-item modern">
          <text class="comparison-label">âœ¨ ç°ä»£æ–‡</text>
          <view class="text-content">
            <text class="text-display">{{modernizeResult.modernText}}</text>
          </view>
        </view>
      </view>

      <!-- æ”¹å†™è¯´æ˜ -->
      <view class="explanation-section" wx:if="{{modernizeResult.explanation}}">
        <text class="explanation-title">ğŸ’¡ æ”¹å†™è¯´æ˜</text>
        <text class="explanation-text">{{modernizeResult.explanation}}</text>
      </view>

      <!-- å…³é”®å˜åŒ– -->
      <view class="changes-section" wx:if="{{modernizeResult.keyChanges}}">
        <text class="changes-title">ğŸ”„ å…³é”®å˜åŒ–</text>
        <view class="changes-list">
          <view 
            class="change-item"
            wx:for="{{modernizeResult.keyChanges}}"
            wx:key="*this"
          >
            <text class="change-bullet">â€¢</text>
            <text class="change-text">{{item}}</text>
          </view>
        </view>
      </view>

      <!-- è´¨é‡è¯„ä¼° -->
      <view class="quality-section">
        <text class="quality-title">ğŸ“Š æ”¹å†™è´¨é‡</text>
        <view class="quality-metrics">
          <view class="metric-item">
            <text class="metric-label">å¯è¯»æ€§</text>
            <view class="metric-bar">
              <view class="metric-fill" style="width: {{modernizeResult.readability || 85}}%"></view>
            </view>
            <text class="metric-value">{{modernizeResult.readability || 85}}%</text>
          </view>
          <view class="metric-item">
            <text class="metric-label">å‡†ç¡®æ€§</text>
            <view class="metric-bar">
              <view class="metric-fill" style="width: {{modernizeResult.accuracy || 92}}%"></view>
            </view>
            <text class="metric-value">{{modernizeResult.accuracy || 92}}%</text>
          </view>
          <view class="metric-item">
            <text class="metric-label">æ–‡åŒ–ä¿ç•™</text>
            <view class="metric-bar">
              <view class="metric-fill" style="width: {{modernizeResult.culturalPreservation || 78}}%"></view>
            </view>
            <text class="metric-value">{{modernizeResult.culturalPreservation || 78}}%</text>
          </view>
        </view>
      </view>

      <!-- ç›¸å…³æ¨è -->
      <view class="related-section" wx:if="{{relatedTexts.length > 0}}">
        <text class="related-title">ğŸ“š ç›¸å…³å†…å®¹</text>
        <view class="related-list">
          <view 
            class="related-item"
            wx:for="{{relatedTexts}}"
            wx:key="id"
            bindtap="onRelatedClick"
            data-item="{{item}}"
          >
            <text class="related-text">{{item.text}}</text>
            <text class="related-source">ã€Š{{item.source}}ã€‹</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- å†å²è®°å½• -->
  <view class="history-section" wx:if="{{!modernizeResult && historyList.length > 0}}">
    <view class="history-card">
      <view class="history-header">
        <text class="history-title">ğŸ“‹ æ”¹å†™å†å²</text>
        <text class="clear-history" bindtap="onClearHistory">æ¸…ç©º</text>
      </view>
      
      <view class="history-list">
        <view 
          class="history-item"
          wx:for="{{historyList}}"
          wx:key="id"
          bindtap="onHistoryClick"
          data-item="{{item}}"
        >
          <view class="history-content">
            <text class="history-original">{{item.originalText}}</text>
            <text class="history-modern">{{item.modernText}}</text>
          </view>
          <view class="history-meta">
            <text class="history-time">{{item.createTime}}</text>
            <text class="history-style">{{item.style}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- ä½¿ç”¨æŠ€å·§ -->
  <view class="tips-section" wx:if="{{!modernizeResult && !ancientText}}">
    <view class="tips-card">
      <text class="tips-title">ğŸ’¡ ä½¿ç”¨æŠ€å·§</text>
      <view class="tips-list">
        <view class="tip-item">
          <text class="tip-icon">ğŸ“</text>
          <text class="tip-text">è¾“å…¥å®Œæ•´çš„å¥å­æˆ–æ®µè½ï¼Œæ•ˆæœæ›´ä½³</text>
        </view>
        <view class="tip-item">
          <text class="tip-icon">ğŸ¯</text>
          <text class="tip-text">é€‰æ‹©åˆé€‚çš„ç›®æ ‡å—ä¼—ï¼Œè·å¾—æœ€ä½³æ”¹å†™æ•ˆæœ</text>
        </view>
        <view class="tip-item">
          <text class="tip-icon">âš–ï¸</text>
          <text class="tip-text">è°ƒæ•´ä¿ç•™ç¨‹åº¦ï¼Œå¹³è¡¡ç°ä»£æ€§å’Œæ–‡åŒ–å†…æ¶µ</text>
        </view>
        <view class="tip-item">
          <text class="tip-icon">ğŸ”„</text>
          <text class="tip-text">å°è¯•ä¸åŒé£æ ¼ï¼Œå‘ç°å¤æ–‡çš„å¤šç§è¡¨è¾¾æ–¹å¼</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç»å…¸é€‰æ‹©å¼¹çª— -->
  <view class="classics-modal" wx:if="{{showClassicsModal}}" bindtap="onCloseClassicsModal">
    <view class="modal-content" catchtap="stopPropagation">
      <view class="modal-header">
        <text class="modal-title">é€‰æ‹©ç»å…¸ç‰‡æ®µ</text>
        <text class="modal-close" bindtap="onCloseClassicsModal">Ã—</text>
      </view>
      
      <view class="classics-list">
        <view 
          class="classic-item"
          wx:for="{{classicTexts}}"
          wx:key="id"
          bindtap="onSelectClassicText"
          data-text="{{item.text}}"
        >
          <text class="classic-text">{{item.text}}</text>
          <text class="classic-source">ã€Š{{item.source}}ã€‹</text>
        </view>
      </view>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-overlay" wx:if="{{loading}}">
    <view class="loading-content">
      <view class="loading-spinner">ğŸ¤–</view>
      <text class="loading-text">AIæ­£åœ¨è¿›è¡Œç°ä»£åŒ–æ”¹å†™...</text>
      <text class="loading-desc">è¯·ç¨å€™ï¼Œè¿™å¯èƒ½éœ€è¦å‡ ç§’é’Ÿ</text>
    </view>
  </view>
</view>
