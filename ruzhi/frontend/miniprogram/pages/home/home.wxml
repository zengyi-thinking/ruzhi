<!--é¦–é¡µæ¨¡æ¿-->
<view class="home-container">
  <!-- é¡¶éƒ¨ç”¨æˆ·ä¿¡æ¯åŒºåŸŸ -->
  <view class="user-header">
    <view class="user-info" bindtap="onUserAvatarClick">
      <image 
        class="user-avatar" 
        src="{{hasUserInfo ? userInfo.avatarUrl : '/images/default-avatar.png'}}"
        mode="aspectFill"
      />
      <view class="user-details">
        <text class="user-name">{{hasUserInfo ? userInfo.nickName : 'ç‚¹å‡»ç™»å½•'}}</text>
        <text class="user-desc">{{hasUserInfo ? 'ç»§ç»­å­¦ä¹ ä¼ ç»Ÿæ–‡åŒ–' : 'å¼€å¯æ™ºæ…§ä¹‹æ—…'}}</text>
      </view>
    </view>
    <view class="header-actions">
      <text class="icon-bell">ğŸ””</text>
    </view>
  </view>

  <!-- å­¦ä¹ ç»Ÿè®¡å¡ç‰‡ -->
  <view class="stats-card card" bindtap="onViewStudyStats">
    <view class="stats-header">
      <text class="stats-title">å­¦ä¹ ç»Ÿè®¡</text>
      <text class="icon-arrow">â†’</text>
    </view>
    <view class="stats-content">
      <view class="stat-item">
        <text class="stat-number">{{studyStats.totalDays}}</text>
        <text class="stat-label">å­¦ä¹ å¤©æ•°</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{studyStats.completedChapters}}</text>
        <text class="stat-label">å®Œæˆç« èŠ‚</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{studyStats.ocrCount}}</text>
        <text class="stat-label">è¯†åˆ«æ¬¡æ•°</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{studyStats.totalHours}}</text>
        <text class="stat-label">å­¦ä¹ æ—¶é•¿(h)</text>
      </view>
    </view>
  </view>

  <!-- åŠŸèƒ½æ¨¡å— -->
  <view class="features-section">
    <view class="section-header">
      <text class="section-title">æ ¸å¿ƒåŠŸèƒ½</text>
    </view>
    <view class="features-grid">
      <view 
        class="feature-item" 
        wx:for="{{features}}" 
        wx:key="id"
        data-feature="{{item}}"
        bindtap="onFeatureClick"
      >
        <view class="feature-icon" style="background-color: {{item.color}}20;">
          <image src="{{item.icon}}" class="feature-image" mode="aspectFit" />
        </view>
        <text class="feature-title">{{item.title}}</text>
        <text class="feature-desc">{{item.desc}}</text>
      </view>
    </view>
  </view>

  <!-- ä»Šæ—¥æ¨è -->
  <view class="recommend-section" wx:if="{{todayRecommend.length > 0}}">
    <view class="section-header">
      <text class="section-title">ä»Šæ—¥æ¨è</text>
      <text class="section-more" bindtap="onViewMoreRecommend">æŸ¥çœ‹æ›´å¤š</text>
    </view>
    <scroll-view class="recommend-scroll" scroll-x="true" show-scrollbar="false">
      <view class="recommend-list">
        <view 
          class="recommend-item" 
          wx:for="{{todayRecommend}}" 
          wx:key="id"
          data-item="{{item}}"
          bindtap="onRecommendClick"
        >
          <image src="{{item.image}}" class="recommend-image" mode="aspectFill" />
          <view class="recommend-content">
            <text class="recommend-title">{{item.title}}</text>
            <text class="recommend-text ancient-text">{{item.content}}</text>
          </view>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- æœ€è¿‘ä½¿ç”¨ -->
  <view class="recent-section" wx:if="{{recentUsed.length > 0}}">
    <view class="section-header">
      <text class="section-title">æœ€è¿‘ä½¿ç”¨</text>
    </view>
    <view class="recent-list">
      <view 
        class="recent-item" 
        wx:for="{{recentUsed}}" 
        wx:key="id"
        data-feature="{{item}}"
        bindtap="onFeatureClick"
      >
        <view class="recent-icon" style="background-color: {{item.color}}20;">
          <image src="{{item.icon}}" class="recent-image" mode="aspectFit" />
        </view>
        <view class="recent-info">
          <text class="recent-title">{{item.title}}</text>
          <text class="recent-time">{{item.lastUsed}}</text>
        </view>
        <text class="icon-arrow">â†’</text>
      </view>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading-spinner">â³</view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{!loading && todayRecommend.length === 0 && recentUsed.length === 0}}">
    <view class="empty-icon">ğŸ“š</view>
    <text class="empty-text">æš‚æ— å†…å®¹</text>
  </view>
</view>
