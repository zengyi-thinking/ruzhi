<!--ä¸ªäººä¸­å¿ƒé¡µé¢-->
<view class="page-container traditional-bg">
  <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
  <view class="user-card">
    <view class="user-avatar-section">
      <image
        class="user-avatar"
        src="{{userInfo.avatarUrl || '/images/default-avatar.png'}}"
        mode="aspectFill"
      ></image>
      <view class="user-info">
        <view class="user-name">{{userInfo.nickName || 'æ–‡åŒ–å­¦è€…'}}</view>
        <view class="user-desc">ä¼ ç»Ÿæ–‡åŒ–å­¦ä¹ è€…</view>
      </view>
      <view class="login-section" wx:if="{{!hasUserInfo}}">
        <button class="login-btn" bindtap="getUserProfile">ç™»å½•</button>
      </view>
    </view>
  </view>

  <!-- å­¦ä¹ ç»Ÿè®¡å¡ç‰‡ -->
  <view class="stats-card">
    <view class="card-header">
      <view class="card-title">ğŸ“Š å­¦ä¹ ç»Ÿè®¡</view>
      <view class="stats-toggle" bindtap="toggleStatsDetail">
        <text class="toggle-text">{{showStatsDetail ? 'æ”¶èµ·' : 'è¯¦æƒ…'}}</text>
        <text class="toggle-icon">{{showStatsDetail ? 'â–²' : 'â–¼'}}</text>
      </view>
    </view>

    <view class="stats-overview">
      <view class="stat-item">
        <view class="stat-number">{{learningStats.totalDays}}</view>
        <view class="stat-label">å­¦ä¹ å¤©æ•°</view>
      </view>
      <view class="stat-item">
        <view class="stat-number">{{learningStats.totalHours}}</view>
        <view class="stat-label">å­¦ä¹ æ—¶é•¿</view>
      </view>
      <view class="stat-item">
        <view class="stat-number">{{learningStats.totalPoints}}</view>
        <view class="stat-label">ç§¯åˆ†</view>
      </view>
      <view class="stat-item">
        <view class="stat-number">{{learningStats.currentStreak}}</view>
        <view class="stat-label">è¿ç»­å¤©æ•°</view>
      </view>
    </view>

    <view class="stats-detail" wx:if="{{showStatsDetail}}">
      <view class="detail-item">
        <text class="detail-label">å¹³å‡æ¯æ—¥å­¦ä¹ ï¼š</text>
        <text class="detail-value">{{averageDailyHours}}å°æ—¶</text>
      </view>
      <view class="detail-item">
        <text class="detail-label">å­¦ä¹ æ•ˆç‡ï¼š</text>
        <text class="detail-value">ä¼˜ç§€</text>
      </view>
    </view>

    <view class="stats-action">
      <button class="action-btn" bindtap="viewLearningStats">æŸ¥çœ‹è¯¦ç»†ç»Ÿè®¡</button>
    </view>
  </view>

  <!-- æœ€è¿‘æˆå°± -->
  <view class="achievements-card" wx:if="{{recentAchievements.length > 0}}">
    <view class="card-header">
      <view class="card-title">ğŸ† æœ€è¿‘æˆå°±</view>
      <view class="view-all" bindtap="viewAllAchievements">æŸ¥çœ‹å…¨éƒ¨</view>
    </view>

    <view class="achievements-list">
      <view
        class="achievement-item"
        wx:for="{{recentAchievements}}"
        wx:key="id"
      >
        <view class="achievement-icon">{{item.icon}}</view>
        <view class="achievement-info">
          <view class="achievement-name">{{item.name}}</view>
          <view class="achievement-desc">{{item.description}}</view>
          <view class="achievement-date">{{item.unlockedDate}}</view>
        </view>
      </view>
    </view>
  </view>

  <!-- å­¦ä¹ å†å² -->
  <view class="history-card" wx:if="{{historyRecords.length > 0}}">
    <view class="card-header">
      <view class="card-title">ğŸ“– æœ€è¿‘å­¦ä¹ </view>
    </view>

    <view class="history-list">
      <view
        class="history-item"
        wx:for="{{historyRecords}}"
        wx:key="id"
      >
        <view class="history-icon">{{item.icon}}</view>
        <view class="history-content">
          <view class="history-title">{{item.title}}</view>
          <view class="history-desc">{{item.description}}</view>
          <view class="history-time">{{item.time}}</view>
        </view>
        <view class="history-points">+{{item.points}}</view>
      </view>
    </view>
  </view>

  <!-- åŠŸèƒ½èœå• -->
  <view class="menu-card">
    <view class="card-title">âš™ï¸ åŠŸèƒ½èœå•</view>

    <view class="menu-list">
      <view class="menu-item" bindtap="viewLearningStats">
        <view class="menu-icon">ğŸ“Š</view>
        <view class="menu-content">
          <view class="menu-title">å­¦ä¹ ç»Ÿè®¡</view>
          <view class="menu-desc">æŸ¥çœ‹è¯¦ç»†çš„å­¦ä¹ æ•°æ®å’Œè¿›åº¦</view>
        </view>
        <view class="menu-arrow">â€º</view>
      </view>

      <view class="menu-item" bindtap="viewAllAchievements">
        <view class="menu-icon">ğŸ†</view>
        <view class="menu-content">
          <view class="menu-title">æˆå°±ä¸­å¿ƒ</view>
          <view class="menu-desc">æŸ¥çœ‹è§£é”çš„æˆå°±å’Œå¾½ç« </view>
        </view>
        <view class="menu-arrow">â€º</view>
      </view>

      <view class="menu-item">
        <view class="menu-icon">â­</view>
        <view class="menu-content">
          <view class="menu-title">æˆ‘çš„æ”¶è—</view>
          <view class="menu-desc">ç®¡ç†æ”¶è—çš„å†…å®¹å’Œç¬”è®°</view>
        </view>
        <view class="menu-arrow">â€º</view>
      </view>

      <view class="menu-item">
        <view class="menu-icon">âš™ï¸</view>
        <view class="menu-content">
          <view class="menu-title">è®¾ç½®</view>
          <view class="menu-desc">ä¸ªæ€§åŒ–è®¾ç½®å’Œåå¥½é…ç½®</view>
        </view>
        <view class="menu-arrow">â€º</view>
      </view>

      <view class="menu-item">
        <view class="menu-icon">ğŸ’¬</view>
        <view class="menu-content">
          <view class="menu-title">æ„è§åé¦ˆ</view>
          <view class="menu-desc">å¸®åŠ©æˆ‘ä»¬æ”¹è¿›äº§å“ä½“éªŒ</view>
        </view>
        <view class="menu-arrow">â€º</view>
      </view>

      <view class="menu-item">
        <view class="menu-icon">â„¹ï¸</view>
        <view class="menu-content">
          <view class="menu-title">å…³äºæˆ‘ä»¬</view>
          <view class="menu-desc">äº†è§£å„’æ™ºçš„ä½¿å‘½å’Œæ„¿æ™¯</view>
        </view>
        <view class="menu-arrow">â€º</view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€æç¤º -->
  <view class="empty-state" wx:if="{{recentAchievements.length === 0 && historyRecords.length === 0}}">
    <view class="empty-icon">ğŸ“š</view>
    <view class="empty-title">å¼€å§‹æ‚¨çš„å­¦ä¹ ä¹‹æ—…</view>
    <view class="empty-desc">æ¢ç´¢ä¼ ç»Ÿæ–‡åŒ–çš„æ™ºæ…§å®åº“ï¼Œè®°å½•æ‚¨çš„æˆé•¿è¶³è¿¹</view>
    <button class="start-btn" bindtap="viewLearningStats">å¼€å§‹å­¦ä¹ </button>
  </view>
</view>