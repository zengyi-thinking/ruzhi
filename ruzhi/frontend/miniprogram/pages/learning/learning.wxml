<!--å­¦ä¹ ä¸­å¿ƒé¡µé¢-->
<view class="page-container traditional-bg">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <view class="page-title">ğŸ“š æ™ºèƒ½å­¦ä¹ ä¸­å¿ƒ</view>
    <view class="page-subtitle">ä¸ªæ€§åŒ–å­¦ä¹ ç»Ÿè®¡ä¸æ™ºèƒ½æ¨è</view>
  </view>

  <!-- å­¦ä¹ ç»Ÿè®¡å¡ç‰‡ -->
  <view class="stats-section">
    <view class="card">
      <view class="card-title">ğŸ“Š å­¦ä¹ ç»Ÿè®¡</view>
      <view class="stats-overview">
        <view class="stat-main">
          <view class="stat-number">{{learningStats.totalDays}}</view>
          <view class="stat-label">å­¦ä¹ å¤©æ•°</view>
        </view>
        <view class="stat-grid">
          <view class="stat-item">
            <view class="stat-value">{{learningStats.totalHours}}</view>
            <view class="stat-name">æ€»æ—¶é•¿(å°æ—¶)</view>
          </view>
          <view class="stat-item">
            <view class="stat-value">{{learningStats.totalPoints}}</view>
            <view class="stat-name">ç§¯åˆ†</view>
          </view>
          <view class="stat-item">
            <view class="stat-value">{{learningStats.currentStreak}}</view>
            <view class="stat-name">è¿ç»­å¤©æ•°</view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- å­¦ä¹ è¿›åº¦ -->
  <view class="progress-section">
    <view class="card">
      <view class="card-title">ğŸ¯ å­¦ä¹ è¿›åº¦</view>
      <view class="progress-list">
        <view class="progress-item" wx:for="{{learningProgress}}" wx:key="id">
          <view class="progress-header">
            <view class="progress-icon">{{item.icon}}</view>
            <view class="progress-info">
              <view class="progress-name">{{item.name}}</view>
              <view class="progress-desc">{{item.description}}</view>
            </view>
            <view class="progress-percentage">{{item.progressPercentage}}%</view>
          </view>
          <view class="progress-bar">
            <view class="progress-fill" style="width: {{item.progress * 100}}%"></view>
          </view>
          <view class="progress-meta">
            <text class="progress-current">{{item.current}}/{{item.total}}</text>
            <text class="progress-category">{{item.category}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- æˆå°±ç³»ç»Ÿ -->
  <view class="achievements-section">
    <view class="card">
      <view class="card-title">ğŸ† æˆå°±å¾½ç« </view>
      <view class="achievements-grid">
        <view 
          class="achievement-item {{item.unlocked ? 'unlocked' : 'locked'}}" 
          wx:for="{{achievements}}" 
          wx:key="id"
          bindtap="viewAchievement"
          data-achievement="{{item}}"
        >
          <view class="achievement-icon">{{item.icon}}</view>
          <view class="achievement-name">{{item.name}}</view>
          <view class="achievement-desc">{{item.description}}</view>
          <view class="achievement-progress" wx:if="{{!item.unlocked}}">
            <view class="achievement-bar">
              <view class="achievement-fill" style="width: {{item.achievementPercentage}}%"></view>
            </view>
            <text class="achievement-text">{{item.current}}/{{item.required}}</text>
          </view>
          <view class="achievement-date" wx:if="{{item.unlocked}}">
            {{item.unlockedDate}}
          </view>
        </view>
      </view>
      <view class="achievements-more" bindtap="viewAllAchievements">
        <text>æŸ¥çœ‹å…¨éƒ¨æˆå°± â€º</text>
      </view>
    </view>
  </view>

  <!-- ä¸ªæ€§åŒ–æ¨è -->
  <view class="recommendations-section">
    <view class="card">
      <view class="card-title">ğŸ’¡ ä¸ºæ‚¨æ¨è</view>
      <view class="recommendation-tabs">
        <view 
          class="tab-item {{activeTab === 'concepts' ? 'active' : ''}}" 
          bindtap="switchTab" 
          data-tab="concepts"
        >
          æ¦‚å¿µå­¦ä¹ 
        </view>
        <view 
          class="tab-item {{activeTab === 'classics' ? 'active' : ''}}" 
          bindtap="switchTab" 
          data-tab="classics"
        >
          ç»å…¸é˜…è¯»
        </view>
        <view 
          class="tab-item {{activeTab === 'dialogues' ? 'active' : ''}}" 
          bindtap="switchTab" 
          data-tab="dialogues"
        >
          AIå¯¹è¯
        </view>
      </view>
      
      <view class="recommendation-content">
        <!-- æ¦‚å¿µæ¨è -->
        <view class="recommendation-list" wx:if="{{activeTab === 'concepts'}}">
          <view 
            class="recommendation-item" 
            wx:for="{{conceptRecommendations}}" 
            wx:key="id"
            bindtap="learnConcept"
            data-concept="{{item.concept}}"
          >
            <view class="recommendation-icon">ğŸ§ </view>
            <view class="recommendation-content">
              <view class="recommendation-title">å­¦ä¹ "{{item.concept}}"</view>
              <view class="recommendation-desc">{{item.reason}}</view>
              <view class="recommendation-meta">
                <text class="recommendation-difficulty">{{item.difficulty}}</text>
                <text class="recommendation-time">{{item.estimated_time}}</text>
              </view>
            </view>
            <view class="recommendation-arrow">â€º</view>
          </view>
        </view>

        <!-- ç»å…¸æ¨è -->
        <view class="recommendation-list" wx:if="{{activeTab === 'classics'}}">
          <view 
            class="recommendation-item" 
            wx:for="{{classicsRecommendations}}" 
            wx:key="id"
            bindtap="readClassic"
            data-classic="{{item.classic}}"
          >
            <view class="recommendation-icon">ğŸ“š</view>
            <view class="recommendation-content">
              <view class="recommendation-title">é˜…è¯»ã€Š{{item.classic}}ã€‹</view>
              <view class="recommendation-desc">{{item.description}}</view>
              <view class="recommendation-meta">
                <text class="recommendation-difficulty">{{item.difficulty}}</text>
                <text class="recommendation-time">{{item.estimated_time}}</text>
              </view>
            </view>
            <view class="recommendation-arrow">â€º</view>
          </view>
        </view>

        <!-- å¯¹è¯æ¨è -->
        <view class="recommendation-list" wx:if="{{activeTab === 'dialogues'}}">
          <view 
            class="recommendation-item" 
            wx:for="{{dialogueRecommendations}}" 
            wx:key="id"
            bindtap="startDialogue"
            data-character="{{item.character}}"
            data-topic="{{item.topic}}"
          >
            <view class="recommendation-icon">ğŸ’¬</view>
            <view class="recommendation-content">
              <view class="recommendation-title">ä¸{{item.character}}å¯¹è¯</view>
              <view class="recommendation-desc">{{item.topic}}</view>
              <view class="recommendation-meta">
                <text class="recommendation-difficulty">{{item.difficulty}}</text>
                <text class="recommendation-time">{{item.estimated_time}}</text>
              </view>
            </view>
            <view class="recommendation-arrow">â€º</view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- å­¦ä¹ è®¡åˆ’ -->
  <view class="plan-section">
    <view class="card">
      <view class="card-title">ğŸ“… ä»Šæ—¥å­¦ä¹ è®¡åˆ’</view>
      <view class="plan-list" wx:if="{{todayPlan.length > 0}}">
        <view 
          class="plan-item {{item.completed ? 'completed' : ''}}" 
          wx:for="{{todayPlan}}" 
          wx:key="id"
          bindtap="togglePlanItem"
          data-id="{{item.id}}"
        >
          <view class="plan-checkbox">
            <text class="checkbox-icon">{{item.completed ? 'âœ…' : 'â­•'}}</text>
          </view>
          <view class="plan-content">
            <view class="plan-title">{{item.title}}</view>
            <view class="plan-desc">{{item.description}}</view>
            <view class="plan-time">é¢„è®¡æ—¶é—´: {{item.estimatedTime}}</view>
          </view>
        </view>
      </view>
      <view class="empty-plan" wx:else>
        <view class="empty-icon">ğŸ“</view>
        <view class="empty-text">æš‚æ— å­¦ä¹ è®¡åˆ’</view>
        <view class="empty-desc">ç³»ç»Ÿå°†æ ¹æ®æ‚¨çš„å­¦ä¹ æƒ…å†µè‡ªåŠ¨ç”Ÿæˆä¸ªæ€§åŒ–è®¡åˆ’</view>
      </view>
    </view>
  </view>

  <!-- å­¦ä¹ å†å² -->
  <view class="history-section">
    <view class="card">
      <view class="card-title">ğŸ“– æœ€è¿‘å­¦ä¹ </view>
      <view class="history-list" wx:if="{{recentHistory.length > 0}}">
        <view class="history-item" wx:for="{{recentHistory}}" wx:key="id">
          <view class="history-icon">{{item.icon}}</view>
          <view class="history-content">
            <view class="history-title">{{item.title}}</view>
            <view class="history-desc">{{item.description}}</view>
            <view class="history-time">{{item.time}}</view>
          </view>
          <view class="history-points">+{{item.points}}</view>
        </view>
      </view>
      <view class="empty-history" wx:else>
        <view class="empty-icon">ğŸ“š</view>
        <view class="empty-text">æš‚æ— å­¦ä¹ è®°å½•</view>
        <view class="empty-desc">å¼€å§‹æ‚¨çš„ä¼ ç»Ÿæ–‡åŒ–å­¦ä¹ ä¹‹æ—…å§</view>
      </view>
    </view>
  </view>
</view>
