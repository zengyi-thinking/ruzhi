<!--ç»å…¸åº“é¡µé¢-->
<view class="classics-container">
  <!-- æœç´¢æ  -->
  <view class="search-section">
    <view class="search-bar">
      <input
        class="search-input"
        placeholder="æœç´¢ç»å…¸ã€ç« èŠ‚æˆ–å†…å®¹..."
        value="{{searchKeyword}}"
        bindinput="onSearchInput"
        bindconfirm="onSearchConfirm"
      />
      <view class="search-btn" bindtap="onSearchConfirm">
        <text class="search-icon">ğŸ”</text>
      </view>
    </view>

    <!-- æœç´¢å»ºè®® -->
    <view class="search-suggestions" wx:if="{{showSuggestions && searchSuggestions.length > 0}}">
      <view
        class="suggestion-item"
        wx:for="{{searchSuggestions}}"
        wx:key="id"
        bindtap="onSuggestionClick"
        data-suggestion="{{item}}"
      >
        <text class="suggestion-text">{{item.text}}</text>
        <text class="suggestion-type">{{item.type}}</text>
      </view>
    </view>
  </view>

  <!-- åˆ†ç±»ç­›é€‰ -->
  <view class="category-section">
    <scroll-view class="category-scroll" scroll-x="true" show-scrollbar="false">
      <view class="category-list">
        <view
          class="category-item {{selectedCategory === item.id ? 'active' : ''}}"
          wx:for="{{categories}}"
          wx:key="id"
          bindtap="onCategorySelect"
          data-category="{{item}}"
        >
          <text class="category-icon">{{item.icon}}</text>
          <text class="category-name">{{item.name}}</text>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- ç»å…¸ä¹¦ç±åˆ—è¡¨ -->
  <view class="classics-section">
    <!-- æ¨èç»å…¸ -->
    <view class="section-header" wx:if="{{recommendedBooks.length > 0}}">
      <text class="section-title">ğŸ“š æ¨èç»å…¸</text>
      <text class="section-more" bindtap="onViewAllRecommended">æŸ¥çœ‹å…¨éƒ¨</text>
    </view>

    <scroll-view class="recommended-scroll" scroll-x="true" show-scrollbar="false" wx:if="{{recommendedBooks.length > 0}}">
      <view class="recommended-list">
        <view
          class="recommended-book"
          wx:for="{{recommendedBooks}}"
          wx:key="id"
          bindtap="onBookClick"
          data-book="{{item}}"
        >
          <image class="book-cover" src="{{item.cover}}" mode="aspectFill" />
          <view class="book-info">
            <text class="book-title">{{item.title}}</text>
            <text class="book-author">{{item.author}}</text>
            <view class="book-stats">
              <text class="stat-item">{{item.chapters}}ç« </text>
              <text class="stat-item">{{item.readCount}}äººè¯»è¿‡</text>
            </view>
          </view>
        </view>
      </view>
    </scroll-view>

    <!-- å…¨éƒ¨ç»å…¸ -->
    <view class="section-header">
      <text class="section-title">ğŸ“– å…¨éƒ¨ç»å…¸</text>
      <view class="sort-options">
        <text
          class="sort-item {{sortBy === 'default' ? 'active' : ''}}"
          bindtap="onSortChange"
          data-sort="default"
        >é»˜è®¤</text>
        <text
          class="sort-item {{sortBy === 'popular' ? 'active' : ''}}"
          bindtap="onSortChange"
          data-sort="popular"
        >çƒ­é—¨</text>
        <text
          class="sort-item {{sortBy === 'latest' ? 'active' : ''}}"
          bindtap="onSortChange"
          data-sort="latest"
        >æœ€æ–°</text>
      </view>
    </view>

    <view class="books-grid">
      <view
        class="book-card"
        wx:for="{{filteredBooks}}"
        wx:key="id"
        bindtap="onBookClick"
        data-book="{{item}}"
      >
        <image class="book-cover-large" src="{{item.cover}}" mode="aspectFill" />
        <view class="book-content">
          <view class="book-header">
            <text class="book-title-large">{{item.title}}</text>
            <view class="book-tags">
              <text class="book-tag" wx:for="{{item.tags}}" wx:key="*this">{{item}}</text>
            </view>
          </view>

          <view class="book-meta">
            <text class="book-author-large">{{item.author}}</text>
            <text class="book-dynasty">{{item.dynasty}}</text>
          </view>

          <text class="book-description">{{item.description}}</text>

          <view class="book-footer">
            <view class="book-progress" wx:if="{{item.progress > 0}}">
              <text class="progress-text">å·²è¯» {{item.progress}}%</text>
              <view class="progress-bar">
                <view class="progress-fill" style="width: {{item.progress}}%"></view>
              </view>
            </view>

            <view class="book-actions">
              <text class="action-btn read-btn">{{item.progress > 0 ? 'ç»§ç»­é˜…è¯»' : 'å¼€å§‹é˜…è¯»'}}</text>
              <text class="action-btn favorite-btn {{item.isFavorite ? 'active' : ''}}"
                    bindtap="onToggleFavorite"
                    data-book="{{item}}"
                    catchtap="true">
                {{item.isFavorite ? 'â¤ï¸' : 'ğŸ¤'}}
              </text>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading-spinner">â³</view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{!loading && filteredBooks.length === 0}}">
    <view class="empty-icon">ğŸ“š</view>
    <text class="empty-title">æš‚æ— ç›¸å…³ç»å…¸</text>
    <text class="empty-desc">{{searchKeyword ? 'å°è¯•å…¶ä»–å…³é”®è¯æœç´¢' : 'æ•¬è¯·æœŸå¾…æ›´å¤šç»å…¸å†…å®¹'}}</text>
    <button class="empty-btn" bindtap="onClearSearch" wx:if="{{searchKeyword}}">æ¸…é™¤æœç´¢</button>
  </view>
</view>